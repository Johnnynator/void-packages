# Template file for 'dde-file-manager'
pkgname=dde-file-manager
version=4.8.6
revision=1
build_style=qmake
configure_args="PREFIX=/usr CONFIG+=DISABLE_ANYTHING" #Disable only for cros
hostmakedepends="qt5-qmake pkg-config deepin-gettext-tools"
makedepends="deepin-anything-devel dde-dock-devel gsettings-qt-devel taglib-devel
 ffmpegthumbnailer-devel xcb-util-wm-devel qt5-svg-devel qt5-x11extras-devel
 polkit-qt5-devel libsecret-devel gtk+-devel poppler-cpp-devel uchardet-devel
 dtkwidget-devel qt5-multimedia-devel deepin-movie-reborn-devel kcodecs-devel
 udisks2-qt5-devel dde-qt-dbus-factory-devel pulseaudio-devel jemalloc-devel
 deepin-anything-server"
depends="qt5integration avfs treefrog-framework"
short_desc="Deepin File Manager"
maintainer="John <johnz@posteo.net>"
license="GPL-3.0-or-later"
homepage="https://github.com/linuxdeepin/dde-file-manager"
changelog="https://github.com/linuxdeepin/dde-file-manager/blob/${version}/CHANGELOG.md"
distfiles="https://github.com/linuxdeepin/dde-file-manager/archive/${version}.tar.gz"
checksum=c66aa73d4ef83a393d6486aaf4326f3f9d093da2caa0c33881162483c7afbe43

post_install() {
	rm -rf ${DESTDIR}/lib
}
#TODO: systemd

dde-desktop_package() {
	short_desc="Depin Desktop"
	depends="dde-dock dde-control-center dde-launcher dde-session-ui deepin-wallpapers"
	pkg_install() {
		vmove usr/bin/dde-desktop
		vmove usr/share/dbus-1/services/com.deepin.dde.desktop.service
		vmove usr/share/dde-desktop
	}
}

dde-file-manager-devel_package() {
	short_desc+=" - development files"
	depends="${sourcepkg}>=${version}_${revision}"
	pkg_install() {
		vmove usr/include
		vmove usr/lib/pkgconfig
		vmove "usr/lib/*.so"
	}
}

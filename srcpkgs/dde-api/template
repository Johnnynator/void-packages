# Template file for 'dde-api'
pkgname=dde-api
version=3.18.4
revision=1
build_style=gnu-makefile
nopie=yes
nostrip=yes
make_build_args="GOPATH=/usr/share/gocode"
hostmakedepends="go deepin-go-lib dbus-factory go-gir-generator
 pkg-config git deepin-gettext-tools python3 go-dbus-factory"
makedepends="libglib-devel gtk+3-devel libcanberra-devel alsa-lib-devel
 librsvg-devel poppler-glib-devel libgudev-devel"
depends="xcur2png blur-effect deepin-desktop-base"
short_desc="Go-lang bingdings for dde-daemon"
maintainer="John <johnz@posteo.net>"
license="GPL-3-or-later"
homepage="https://github.com/linuxdeepin/dde-api"
distfiles="https://github.com/linuxdeepin/dde-api/archive/${version}.tar.gz"
checksum=29f6cb570d2a9ca9fdff19d2be7b5e451969d9030ed5da2eb9c5b72d57f9feaa
nocross=yes #Makefile not suitable for cross building

pre_build() {
	export GOPATH="${wrksrc}/gobuild:/usr/share/gocode"
	go get gopkg.in/alecthomas/kingpin.v2
	go get github.com/nfnt/resize
	go get github.com/cryptix/wav
	go get golang.org/x/net/context
	go get github.com/disintegration/imaging github.com/fogleman/gg
	make build-dep
}

post_install() {
	rm -rf ${DESTDIR}/lib
}

#TODO: add devel subpackage
#TODO: remove systemd dep

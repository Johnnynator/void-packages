# Template file for 'sunshine'
pkgname=sunshine
version=0.21.0
revision=1
_moonlight_common_c_commit=f78f2135fa49e19855c2028b6865657d42d511f1
_Simple_Web_Server_commit=2f29926dbbcd8a0425064d98c24f37ac50bd0b5b
_ViGEmClient_commit=b66d02d57e32cc8595369c53418b843e958649b4
_miniupnp_commit=e439318cf782e30066d430f27a1365e013a5ab94
_nv_codec_headers_commit=9402b5a7693e9841f8a4f4488cd2df21ac55c685
_TPCircularBuffer_commit=8833b3a73fab6530cc51e2063a85cced01714cfb
_nanors_commit=395e5ada44dd8d5974eaf6bb6b17f23406e3ca72
_tray_commit=2664388b0ed88234674a37f8cd569747522247b4
_nvapi_open_source_sdk_commit=c0f5f7b64d2ef13b1155f078a2eec156611f2415
_wayland_protocols_commit=681c33c8547d6aefe24455ba2bffe1c5ae11fee5
_wlr_protocols_commit=4264185db3b7e961e7f157e1cc4fd0ab75137568
_enet_commit=bbfe93c248ce198246328d52bda5b4e6dd4cc95e
build_style=cmake
configure_args="-DSYSTEM_FFMPEG=ON"
hostmakedepends="pkg-config"
makedepends="boost-devel openssl-devel libcurl-devel libdrm-devel
 libcap-devel libayatana-appindicator-devel libnotify-devel
 ffmpeg-devel AMF pulseaudio-devel libva-devel opus-devel
 libevdev-devel"
short_desc="Self-hosted game stream host for Moonlight"
maintainer="John <me@johnnynator.dev>"
license="GPL-3.0-or-later"
homepage="https://github.com/LizardByte/Sunshine"
#changelog=""
distfiles="https://github.com/LizardByte/Sunshine/archive/refs/tags/v${version}.tar.gz
 https://github.com/moonlight-stream/moonlight-common-c/archive/${_moonlight_common_c_commit}.tar.gz
 https://gitlab.com/eidheim/Simple-Web-Server/-/archive/${_Simple_Web_Server_commit}/Simple_Web_Server-${_Simple_Web_Server_commit}.tar.gz
 https://github.com/nefarius/ViGEmClient/archive/${_ViGEmClient_commit}.tar.gz
 https://github.com/miniupnp/miniupnp/archive/${_miniupnp_commit}.tar.gz
 https://github.com/FFmpeg/nv-codec-headers/archive/${_nv_codec_headers_commit}.tar.gz
 https://github.com/michaeltyson/TPCircularBuffer/archive/${_TPCircularBuffer_commit}.tar.gz
 https://github.com/sleepybishop/nanors/archive/${_nanors_commit}.tar.gz
 https://github.com/LizardByte/tray/archive/${_tray_commit}.tar.gz
 https://github.com/LizardByte/nvapi-open-source-sdk/archive/${_nvapi_open_source_sdk_commit}.tar.gz
 https://gitlab.freedesktop.org/wayland/wayland-protocols/-/archive/${_wayland_protocols_commit}/wayland_protocols-${_wayland_protocols_commit}.tar.gz
 https://gitlab.freedesktop.org/wlroots/wlr-protocols/-/archive/${_wlr_protocols_commit}/wlr_protocols-${_wlr_protocols_commit}.tar.gz
 https://github.com/cgutman/enet/archive/${_enet_commit}.tar.gz"
checksum="75ac232d573074ad20a18c28e0adedc06ecfd2df12729c80b3c8c755d66a958f
 d0e56eb2f30962daa41c76c72a567614e8d49cb78f76419dd2f3e6ba565504ed
 9e37dd60f79f72d4cacaa75aa0b46918f87d3877aa4a8b104f7940b2055d6629
 c2bc824cc96ed18cf0620b734ae552474f107e7e680485e5c0cb63e675d9f72a
 31839b9a4d7396f356c947a24307ff6ee94e95c6735e98baee3b7ca798758bad
 afb70ad74ed95a4d86ffa4cebe7bcb396131f1bb627924bee4a0dfd8c3cb8819
 e7bf9d090be90e419860019e6ae125bb07b6aa4d67485e70c93e3e11d41938ee
 ee43241a9357805e45b25db29b92fdd85461037e79f3f96774af3b219af42000
 2a4e6488493921eb396e25397cf48a339c4c70e910c089d06e3bb87bdcf96a3d
 d97efcff3bb86472dd4f602044903a3527a2c850eeebfb9b039ab50d2a237223
 fd2b96c75dc5ad56fac81d08892c8849ab8b9b62a18fa9ad8310ac5817777dd3
 787675c9873399a1b90fb38eed2e161468c8997213d94b188f69552270042695
 2eff0209d7e5d33a37e87b59ac44a8fbe7b91c4562ddeabedec2ad459ac6f91d"

skip_extraction="
 ${_moonlight_common_c_commit}.tar.gz
 Simple_Web_Server-${_Simple_Web_Server_commit}.tar.gz
 ${_ViGEmClient_commit}.tar.gz
 ${_miniupnp_commit}.tar.gz
 ${_nv_codec_headers_commit}.tar.gz
 ${_TPCircularBuffer_commit}.tar.gz
 ${_nanors_commit}.tar.gz
 ${_tray_commit}.tar.gz
 ${_nvapi_open_source_sdk_commit}.tar.gz
 wayland_protocols-${_wayland_protocols_commit}.tar.gz
 wlr_protocols-${_wlr_protocols_commit}.tar.gz
 ${_enet_commit}.tar.gz
 "

post_extract() {
         vsrcextract -C third-party/moonlight-common-c ${_moonlight_common_c_commit}.tar.gz
         vsrcextract -C third-party/moonlight-common-c/enet ${_enet_commit}.tar.gz
         vsrcextract -C third-party/Simple-Web-Server Simple_Web_Server-${_Simple_Web_Server_commit}.tar.gz
         vsrcextract -C third-party/ViGEmClient ${_ViGEmClient_commit}.tar.gz
         vsrcextract -C third-party/miniupnp ${_miniupnp_commit}.tar.gz
         vsrcextract -C third-party/nv-codec-headers ${_nv_codec_headers_commit}.tar.gz
         vsrcextract -C third-party/TPCircularBuffer ${_TPCircularBuffer_commit}.tar.gz
         vsrcextract -C third-party/nanors ${_nanors_commit}.tar.gz
         vsrcextract -C third-party/tray ${_tray_commit}.tar.gz
         vsrcextract -C third-party/nvapi-open-source-sdk ${_nvapi_open_source_sdk_commit}.tar.gz
         vsrcextract -C third-party/wayland-protocols wayland_protocols-${_wayland_protocols_commit}.tar.gz
         vsrcextract -C third-party/wlr-protocols wlr_protocols-${_wlr_protocols_commit}.tar.gz
}
